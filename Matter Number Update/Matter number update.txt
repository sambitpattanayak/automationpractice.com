import {element, browser, $, $$, by} from 'protractor';
import { AppPage } from '../app.po';
import { MatterNumberUpdate } from './matter-number-update.po';
import { Invoices } from '../invoices/invoices.po';
import { Payment } from '../make-payment/make-a-payment.po';
import { PaymentSearch } from '../payment/paymentSearch.po';
const data = require('../app.e2e-test_data.json');
const testEnv = browser.params.environment.env;
const userType = browser.params.user_type.isExternal;

describe('Matter Number Update', () => {
    let app: AppPage;
    let inv: Invoices;
    let pay: Payment;
    let paysrc: PaymentSearch;
    let matter: MatterNumberUpdate;
    beforeAll(async () => {
        app = new AppPage();
        inv = new Invoices();
        pay = new Payment ();
        matter = new MatterNumberUpdate();
        paysrc = new PaymentSearch ();
        await app.appLogin(testEnv, userType);
        await app.waitForUrlToChangeTo('dashboard');
        await app.setCustomerOrInvoice(app.readExcel(2, 'B2'));
        await app.waitForMainLoader();
        console.log('before all completed.');
    });
    afterAll(async () => {
        await app.appLogout();
    });
    beforeEach(async () => {
        await browser.sleep(3000);
        });

    it('should update matter number for Open Invoices', async () => {
        await browser.sleep(2000);
        await inv.clickonInvoiceTab();
        await browser.sleep(2000);
        await inv.clickonInvoiceStatusDropdown();
        await browser.sleep(1000);
        await inv.clickonInvoiceStatusDropdownAll();
        await browser.sleep(1000);
        await inv.clickSearchButton();
        await app.waitForMainLoader();
        await browser.executeScript('window.scrollTo(0,2000)');
        await matter.FilterInvoice(matter.readExcelMatterNumberUpdate(0, 'B10'));
        await browser.sleep(5000);
        const checkboxes = element.all(by.className('k-checkbox-label'));
        const checkboxes_count = await checkboxes.count();
        await browser.executeScript('document.getElementsByClassName("k-icon k-i-edit col s2 no-padding right").item(0).click()');
        await app.waitForMainLoader();
        await expect($('.k-dialog-title').getText()).toBe(data.matterupdate.static_text1);
        await expect($('.cscForm label').getText()).toBe(data.matterupdate.static_text2);
        await expect($('.k-primary.header-button').getText()).toBe(data.matterupdate.static_text3);
        await expect($('.k-tertiary').getText()).toBe(data.matterupdate.static_text4);
        await expect($('.k-dialog-content .no-padding').getText()).toContain(data.matterupdate.static_text5);
        await expect($('.k-dialog-content .no-padding').getText()).toContain(data.matterupdate.static_text6);
        await expect($('[ng-reflect-total="1"]').isPresent()).toBe(true);
        await expect($$('[value="25"]').get(0).getText()).toContain(data.matterupdate.pagination1);
        await expect($$('[value="50"]').get(0).getText()).toContain(data.matterupdate.pagination2);
        await expect($$('[value="75"]').get(0).getText()).toContain(data.matterupdate.pagination3);
        await expect($$('[value="100"]').get(0).getText()).toContain(data.matterupdate.pagination4);
        await $('.cscForm .ng-untouched').sendKeys(matter.readExcelMatterNumberUpdate(0, 'B2'));
        const checkbox = element.all(by.className('k-checkbox-label')).get(checkboxes_count);
        await browser.executeScript('arguments[0].click();', checkbox);
        await $('.k-primary.header-button').click();
        await $('.k-tertiary').click();
        await app.waitForMainLoader();
        await expect($$('div.toaster-body.csc-success').isDisplayed()).toBeTruthy();
        await browser.sleep(5000);
        await $('[aria-label="Close"]').click();
        await app.waitForMainLoader();
        await browser.executeScript('window.scrollTo(0,0)');
        });

    it('should update matter number for Closed Invoices', async () => {
        await browser.sleep(3000);
        await inv.clickonInvoiceTab();
        await inv.clickonInvoiceStatusDropdown();
        await browser.sleep(1000);
        await inv.clickonInvoiceStatusDropdownClosed();
        await browser.sleep(1000);
        await inv.clickSearchButton();
        await app.waitForMainLoader();
        await browser.executeScript('window.scrollTo(0,2000)');
        await matter.FilterInvoice(matter.readExcelMatterNumberUpdate(0, 'B11'));
        await browser.sleep(5000);
        const checkboxes = element.all(by.className('k-checkbox-label'));
        const checkboxes_count = await checkboxes.count();
        await browser.executeScript('document.getElementsByClassName("k-icon k-i-edit col s2 no-padding right").item(0).click()');
        await app.waitForMainLoader();
        await expect($('.k-dialog-title').getText()).toBe(data.matterupdate.static_text1);
        await expect($('.cscForm label').getText()).toBe(data.matterupdate.static_text2);
        await expect($('.k-primary.header-button').getText()).toBe(data.matterupdate.static_text3);
        await expect($('.k-tertiary').getText()).toBe(data.matterupdate.static_text4);
        await expect($('.k-dialog-content .no-padding').getText()).toContain(data.matterupdate.static_text5);
        await expect($('.k-dialog-content .no-padding').getText()).toContain(data.matterupdate.static_text6);
        await expect($('[ng-reflect-total="1"]').isPresent()).toBe(true);
        await expect($$('[value="25"]').get(0).getText()).toContain(data.matterupdate.pagination1);
        await expect($$('[value="50"]').get(0).getText()).toContain(data.matterupdate.pagination2);
        await expect($$('[value="75"]').get(0).getText()).toContain(data.matterupdate.pagination3);
        await expect($$('[value="100"]').get(0).getText()).toContain(data.matterupdate.pagination4);
        await $('.cscForm .ng-untouched').sendKeys(matter.readExcelMatterNumberUpdate(0, 'B2'));
        const checkbox = element.all(by.className('k-checkbox-label')).get(checkboxes_count);
        await browser.executeScript('arguments[0].click();', checkbox);
        await $('.k-primary.header-button').click();
        await $('.k-tertiary').click();
        await app.waitForMainLoader();
        await expect($$('div.toaster-body.csc-success').isDisplayed()).toBeTruthy();
        await browser.sleep(5000);
        await $('[aria-label="Close"]').click();
        await app.waitForMainLoader();
        await browser.executeScript('window.scrollTo(0,0)');
        });

    it('should update matter number of Single Invoice for All Lines', async () => {
        await inv.clickonInvoiceStatusDropdown();
        await browser.sleep(1000);
        await inv.clickonInvoiceStatusDropdownAll();
        await browser.sleep(1000);
        await inv.clickSearchButton();
        await app.waitForMainLoader();
        await browser.executeScript('window.scrollTo(0,2000)');
        await matter.FilterInvoice(matter.readExcelMatterNumberUpdate(0, 'B11'));
        await browser.sleep(5000);
        const checkboxes = element.all(by.className('k-checkbox-label'));
        const checkboxes_count = await checkboxes.count();
        await browser.executeScript('document.getElementsByClassName("k-icon k-i-edit col s2 no-padding right").item(0).click()');
        await app.waitForMainLoader();
        await expect($('.k-dialog-title').getText()).toBe(data.matterupdate.static_text1);
        await expect($('.cscForm label').getText()).toBe(data.matterupdate.static_text2);
        await expect($('.k-primary.header-button').getText()).toBe(data.matterupdate.static_text3);
        await expect($('.k-tertiary').getText()).toBe(data.matterupdate.static_text4);
        await expect($('.k-dialog-content .no-padding').getText()).toContain(data.matterupdate.static_text5);
        await expect($('.k-dialog-content .no-padding').getText()).toContain(data.matterupdate.static_text6);
        await expect($('[ng-reflect-total="1"]').isPresent()).toBe(true);
        await expect($$('[value="25"]').get(0).getText()).toContain(data.matterupdate.pagination1);
        await expect($$('[value="50"]').get(0).getText()).toContain(data.matterupdate.pagination2);
        await expect($$('[value="75"]').get(0).getText()).toContain(data.matterupdate.pagination3);
        await expect($$('[value="100"]').get(0).getText()).toContain(data.matterupdate.pagination4);
        await $('.cscForm .ng-untouched').sendKeys(matter.readExcelMatterNumberUpdate(0, 'B2'));
        const checkbox = element.all(by.className('k-checkbox-label')).get(checkboxes_count);
        await browser.executeScript('arguments[0].click();', checkbox);
        await $('.k-primary.header-button').click();
        await $('.k-tertiary').click();
        await app.waitForMainLoader();
        await expect($$('div.toaster-body.csc-success').isDisplayed()).toBeTruthy();
        await browser.sleep(5000);
        await $('[aria-label="Close"]').click();
        await app.waitForMainLoader();
        await browser.executeScript('window.scrollTo(0,0)');
        });

    xit('should update matter number for OPEN CURRENT Invoices', async () => { // test data not present
        await inv.clickSearchButton();
        await app.waitForMainLoader();
        await inv.ClickOnOpenCurrent();
        await app.waitForMainLoader();
        await browser.executeScript('window.scrollTo(0,2000)');
        await matter.FilterInvoice(matter.readExcelMatterNumberUpdate(0, 'B15'));
        await browser.sleep(5000);
        const checkboxes = element.all(by.className('k-checkbox-label'));
        const checkboxes_count = await checkboxes.count();
        await browser.executeScript('document.getElementsByClassName("k-icon k-i-edit col s2 no-padding right").item(0).click()');
        await app.waitForMainLoader();
        await expect($('.k-dialog-title').getText()).toBe(data.matterupdate.static_text1);
        await expect($('.cscForm label').getText()).toBe(data.matterupdate.static_text2);
        await expect($('.k-primary.header-button').getText()).toBe(data.matterupdate.static_text3);
        await expect($('.k-tertiary').getText()).toBe(data.matterupdate.static_text4);
        await expect($('.k-dialog-content .no-padding').getText()).toContain(data.matterupdate.static_text5);
        await expect($('.k-dialog-content .no-padding').getText()).toContain(data.matterupdate.static_text6);
        await expect($('[ng-reflect-total="1"]').isPresent()).toBe(true);
        await expect($$('[value="25"]').get(0).getText()).toContain(data.matterupdate.pagination1);
        await expect($$('[value="50"]').get(0).getText()).toContain(data.matterupdate.pagination2);
        await expect($$('[value="75"]').get(0).getText()).toContain(data.matterupdate.pagination3);
        await expect($$('[value="100"]').get(0).getText()).toContain(data.matterupdate.pagination4);
        await $('.cscForm .ng-untouched').sendKeys(matter.readExcelMatterNumberUpdate(0, 'B2'));
        const checkbox = element.all(by.className('k-checkbox-label')).get(checkboxes_count);
        await browser.executeScript('arguments[0].click();', checkbox);
        await $('.k-primary.header-button').click();
        await $('.k-tertiary').click();
        await app.waitForMainLoader();
        await expect($$('div.toaster-body.csc-success').isDisplayed()).toBeTruthy();
        await browser.sleep(5000);
        await $('[aria-label="Close"]').click();
        await app.waitForMainLoader();
        await browser.executeScript('window.scrollTo(0,0)');
        });

    it('should update matter number for CLOSED FOR NON-PAYMENT Invoices', async () => {
        await inv.clickSearchButton();
        await app.waitForMainLoader();
        await inv.ClickOnClosedForNP();
        await app.waitForMainLoader();
        await browser.executeScript('window.scrollTo(0,2000)');
        await matter.FilterInvoice(matter.readExcelMatterNumberUpdate(0, 'B12'));
        await browser.sleep(5000);
        const checkboxes = element.all(by.className('k-checkbox-label'));
        const checkboxes_count = await checkboxes.count();
        await browser.executeScript('document.getElementsByClassName("k-icon k-i-edit col s2 no-padding right").item(0).click()');
        await app.waitForMainLoader();
        await expect($('.k-dialog-title').getText()).toBe(data.matterupdate.static_text1);
        await expect($('.cscForm label').getText()).toBe(data.matterupdate.static_text2);
        await expect($('.k-primary.header-button').getText()).toBe(data.matterupdate.static_text3);
        await expect($('.k-tertiary').getText()).toBe(data.matterupdate.static_text4);
        await expect($('.k-dialog-content .no-padding').getText()).toContain(data.matterupdate.static_text5);
        await expect($('.k-dialog-content .no-padding').getText()).toContain(data.matterupdate.static_text6);
        await expect($('[ng-reflect-total="1"]').isPresent()).toBe(true);
        await expect($$('[value="25"]').get(0).getText()).toContain(data.matterupdate.pagination1);
        await expect($$('[value="50"]').get(0).getText()).toContain(data.matterupdate.pagination2);
        await expect($$('[value="75"]').get(0).getText()).toContain(data.matterupdate.pagination3);
        await expect($$('[value="100"]').get(0).getText()).toContain(data.matterupdate.pagination4);
        await $('.cscForm .ng-untouched').sendKeys(matter.readExcelMatterNumberUpdate(0, 'B2'));
        const checkbox = element.all(by.className('k-checkbox-label')).get(checkboxes_count);
        await browser.executeScript('arguments[0].click();', checkbox);
        await $('.k-primary.header-button').click();
        await $('.k-tertiary').click();
        await app.waitForMainLoader();
        await expect($$('div.toaster-body.csc-success').isDisplayed()).toBeTruthy();
        await browser.sleep(5000);
        await $('[aria-label="Close"]').click();
        await app.waitForMainLoader();
        await browser.executeScript('window.scrollTo(0,0)');
        });

    it('should update matter number for PAST DUE Invoices', async () => {
        await inv.clickSearchButton();
        await app.waitForMainLoader();
        await inv.ClickOnPastDue();
        await app.waitForMainLoader();
        await browser.executeScript('window.scrollTo(0,2000)');
        await matter.FilterInvoice(matter.readExcelMatterNumberUpdate(0, 'B13'));
        await browser.sleep(5000);
        const checkboxes = element.all(by.className('k-checkbox-label'));
        const checkboxes_count = await checkboxes.count();
        await browser.executeScript('document.getElementsByClassName("k-icon k-i-edit col s2 no-padding right").item(0).click()');
        await app.waitForMainLoader();
        await expect($('.k-dialog-title').getText()).toBe(data.matterupdate.static_text1);
        await expect($('.cscForm label').getText()).toBe(data.matterupdate.static_text2);
        await expect($('.k-primary.header-button').getText()).toBe(data.matterupdate.static_text3);
        await expect($('.k-tertiary').getText()).toBe(data.matterupdate.static_text4);
        await expect($('.k-dialog-content .no-padding').getText()).toContain(data.matterupdate.static_text5);
        await expect($('.k-dialog-content .no-padding').getText()).toContain(data.matterupdate.static_text6);
        await expect($('[ng-reflect-total="1"]').isPresent()).toBe(true);
        await expect($$('[value="25"]').get(0).getText()).toContain(data.matterupdate.pagination1);
        await expect($$('[value="50"]').get(0).getText()).toContain(data.matterupdate.pagination2);
        await expect($$('[value="75"]').get(0).getText()).toContain(data.matterupdate.pagination3);
        await expect($$('[value="100"]').get(0).getText()).toContain(data.matterupdate.pagination4);
        await $('.cscForm .ng-untouched').sendKeys(matter.readExcelMatterNumberUpdate(0, 'B2'));
        const checkbox = element.all(by.className('k-checkbox-label')).get(checkboxes_count);
        await browser.executeScript('arguments[0].click();', checkbox);
        await $('.k-primary.header-button').click();
        await $('.k-tertiary').click();
        await app.waitForMainLoader();
        await expect($$('div.toaster-body.csc-success').isDisplayed()).toBeTruthy();
        await browser.sleep(5000);
        await $('[aria-label="Close"]').click();
        await app.waitForMainLoader();
        await browser.executeScript('window.scrollTo(0,0)');
        });

    it('should update matter number of Single Invoice for some specific lines', async () => {
        await matter.invoiceSearch();
        await $('.k-i-edit').click();
        await app.waitForMainLoader();
        await expect($('.k-dialog-title').getText()).toBe(data.matterupdate.static_text1);
        await expect($('.cscForm label').getText()).toBe(data.matterupdate.static_text2);
        await expect($('.k-primary.header-button').getText()).toBe(data.matterupdate.static_text3);
        await expect($('.k-tertiary').getText()).toBe(data.matterupdate.static_text4);
        await expect($('.k-dialog-content .no-padding').getText()).toContain(data.matterupdate.static_text5);
        await expect($('.k-dialog-content .no-padding').getText()).toContain(data.matterupdate.static_text6);
        await expect($('[ng-reflect-total="1"]').isPresent()).toBe(true);
        await expect($$('[value="25"]').get(0).getText()).toContain(data.matterupdate.pagination1);
        await expect($$('[value="50"]').get(0).getText()).toContain(data.matterupdate.pagination2);
        await expect($$('[value="75"]').get(0).getText()).toContain(data.matterupdate.pagination3);
        await expect($$('[value="100"]').get(0).getText()).toContain(data.matterupdate.pagination4);
        await $('.cscForm .ng-untouched').sendKeys(matter.readExcelMatterNumberUpdate(0, 'B4'));
        await browser.executeScript('document.getElementsByClassName("k-icon k-plus").item(0).click()');
        await browser.executeScript('document.getElementsByClassName("k-checkbox-label").item(6).click()');
        await $('.k-primary.header-button').click();
        await $('.k-tertiary').click();
        await app.waitForMainLoader();
        await expect($$('div.toaster-body.csc-success').isDisplayed()).toBeTruthy();
        await browser.sleep(5000);
        await $('[aria-label="Close"]').click();
        await app.waitForMainLoader();
        await browser.executeScript('window.scrollTo(0,0)');
        });

    it('should update matter number of Two Invoices for All Lines of Both the Invoice', async () => {
        await inv.clickSearchButton();
        await app.waitForMainLoader();
        const checkboxes = element.all(by.className('k-checkbox-label'));
        const checkboxes_count = await checkboxes.count();
        await browser.executeScript('document.getElementsByClassName("k-checkbox-label").item(25).click()');
        await browser.executeScript('document.getElementsByClassName("k-checkbox-label").item(26).click()');
        const InvoiceOptionDropdown = await $$('span.k-input').get(2);
        await app.waitForEcClickable(InvoiceOptionDropdown);
        await $$('span.k-input').get(2).click();
        const bulkUpdateMatter = $$('li.k-item').get(2);
        await app.waitForEcClickable(bulkUpdateMatter);
        await bulkUpdateMatter.click();
        await app.waitForMainLoader();
        await expect($('.k-dialog-title').getText()).toBe(data.matterupdate.static_text1);
        await expect($('.cscForm label').getText()).toBe(data.matterupdate.static_text2);
        await expect($('.k-primary.header-button').getText()).toBe(data.matterupdate.static_text3);
        await expect($('.k-tertiary').getText()).toBe(data.matterupdate.static_text4);
        await expect($('.k-dialog-content .no-padding').getText()).toContain(data.matterupdate.static_text5);
        await expect($('.k-dialog-content .no-padding').getText()).toContain(data.matterupdate.static_text6);
        await expect($('[ng-reflect-total="2"]').isPresent()).toBe(true);
        await expect($('[ng-reflect-total="2"] [value="25"]').getText()).toContain(data.matterupdate.pagination1);
        await expect($('[ng-reflect-total="2"] [value="50"]').getText()).toContain(data.matterupdate.pagination2);
        await expect($('[ng-reflect-total="2"] [value="75"]').getText()).toContain(data.matterupdate.pagination3);
        await expect($('[ng-reflect-total="2"] [value="100"]').getText()).toContain(data.matterupdate.pagination4);
        await $('.cscForm .ng-untouched').sendKeys(matter.readExcelMatterNumberUpdate(0, 'B3'));
        const checkbox = element.all(by.className('k-checkbox-label')).get(checkboxes_count);
        await browser.executeScript('arguments[0].click();', checkbox);
        await $('.k-primary.header-button').click();
        await $('.k-tertiary').click();
        await app.waitForMainLoader();
        await expect($$('div.toaster-body.csc-success').isDisplayed()).toBeTruthy();
        await browser.sleep(5000);
        await $('[aria-label="Close"]').click();
        await app.waitForMainLoader();
        await browser.executeScript('window.scrollTo(0,0)');
        });

    it('should update matter number of Two Invoices for Few Lines of Both the Invoice', async () => {
        await browser.sleep(5000);
        await inv.clickSearchButton();
        await app.waitForMainLoader();
        const checkboxes = element.all(by.className('k-checkbox-label'));
        await browser.executeScript('document.getElementsByClassName("k-checkbox-label").item(24).click()');
        await browser.executeScript('document.getElementsByClassName("k-checkbox-label").item(26).click()');
        const InvoiceOptionDropdown = await $$('span.k-input').get(2);
        await app.waitForEcClickable(InvoiceOptionDropdown);
        await $$('span.k-input').get(2).click();
        const bulkUpdateMatter = $$('li.k-item').get(2);
        await app.waitForEcClickable(bulkUpdateMatter);
        await bulkUpdateMatter.click();
        await app.waitForMainLoader();
        await expect($('.k-dialog-title').getText()).toBe(data.matterupdate.static_text1);
        await expect($('.cscForm label').getText()).toBe(data.matterupdate.static_text2);
        await expect($('.k-primary.header-button').getText()).toBe(data.matterupdate.static_text3);
        await expect($('.k-tertiary').getText()).toBe(data.matterupdate.static_text4);
        await expect($('.k-dialog-content .no-padding').getText()).toContain(data.matterupdate.static_text5);
        await expect($('.k-dialog-content .no-padding').getText()).toContain(data.matterupdate.static_text6);
        await expect($('[ng-reflect-total="2"]').isPresent()).toBe(true);
        await expect($('[ng-reflect-total="2"] [value="25"]').getText()).toContain(data.matterupdate.pagination1);
        await expect($('[ng-reflect-total="2"] [value="50"]').getText()).toContain(data.matterupdate.pagination2);
        await expect($('[ng-reflect-total="2"] [value="75"]').getText()).toContain(data.matterupdate.pagination3);
        await expect($('[ng-reflect-total="2"] [value="100"]').getText()).toContain(data.matterupdate.pagination4);
        await $('.cscForm .ng-untouched').sendKeys(matter.readExcelMatterNumberUpdate(0, 'B5'));
        await browser.executeScript('document.getElementsByClassName("k-icon k-plus").item(0).click()');
        await browser.executeScript('document.getElementsByClassName("k-checkbox-label").item(30).click()');
        await browser.executeScript('document.getElementsByClassName("k-icon k-plus").item(0).click()');
        await browser.executeScript('document.getElementsByClassName("k-checkbox-label").item(33).click()');
        await $('.k-primary.header-button').click();
        await $('.k-tertiary').click();
        await app.waitForMainLoader();
        await expect($$('div.toaster-body.csc-success').isDisplayed()).toBeTruthy();
        await browser.sleep(5000);
        await $('[aria-label="Close"]').click();
        await app.waitForMainLoader();
        await browser.executeScript('window.scrollTo(0,0)');
        });

    it('should update matter number of Two Invoices for All Lines of 1st Invoice & Few Lines of 2nd Invoice', async () => {
        await browser.sleep(5000);
        await inv.clickSearchButton();
        await app.waitForMainLoader();
        const checkboxes = element.all(by.className('k-checkbox-label'));
        await browser.executeScript('document.getElementsByClassName("k-checkbox-label").item(24).click()');
        await browser.executeScript('document.getElementsByClassName("k-checkbox-label").item(26).click()');
        const InvoiceOptionDropdown = await $$('span.k-input').get(2);
        await app.waitForEcClickable(InvoiceOptionDropdown);
        await $$('span.k-input').get(2).click();
        const bulkUpdateMatter = $$('li.k-item').get(2);
        await app.waitForEcClickable(bulkUpdateMatter);
        await bulkUpdateMatter.click();
        await app.waitForMainLoader();
        await expect($('.k-dialog-title').getText()).toBe(data.matterupdate.static_text1);
        await expect($('.cscForm label').getText()).toBe(data.matterupdate.static_text2);
        await expect($('.k-primary.header-button').getText()).toBe(data.matterupdate.static_text3);
        await expect($('.k-tertiary').getText()).toBe(data.matterupdate.static_text4);
        await expect($('.k-dialog-content .no-padding').getText()).toContain(data.matterupdate.static_text5);
        await expect($('.k-dialog-content .no-padding').getText()).toContain(data.matterupdate.static_text6);
        await expect($('[ng-reflect-total="2"]').isPresent()).toBe(true);
        await expect($('[ng-reflect-total="2"] [value="25"]').getText()).toContain(data.matterupdate.pagination1);
        await expect($('[ng-reflect-total="2"] [value="50"]').getText()).toContain(data.matterupdate.pagination2);
        await expect($('[ng-reflect-total="2"] [value="75"]').getText()).toContain(data.matterupdate.pagination3);
        await expect($('[ng-reflect-total="2"] [value="100"]').getText()).toContain(data.matterupdate.pagination4);
        await $('.cscForm .ng-untouched').sendKeys(matter.readExcelMatterNumberUpdate(0, 'B5'));
        await browser.executeScript('document.getElementsByClassName("k-checkbox-label").item(28).click()');
        await browser.executeScript('document.getElementsByClassName("k-icon k-plus").item(1).click()');
        await browser.executeScript('document.getElementsByClassName("k-checkbox-label").item(31).click()');
        await $('.k-primary.header-button').click();
        await $('.k-tertiary').click();
        await app.waitForMainLoader();
        await expect($$('div.toaster-body.csc-success').isDisplayed()).toBeTruthy();
        await browser.sleep(5000);
        await $('[aria-label="Close"]').click();
        await app.waitForMainLoader();
        await browser.executeScript('window.scrollTo(0,0)');
        });

    it('should update matter number of Two Invoices for Few Lines of 1st Invoice & All Lines of 2nd Invoice', async () => {
        await browser.sleep(5000);
        await inv.clickSearchButton();
        await app.waitForMainLoader();
        const checkboxes = element.all(by.className('k-checkbox-label'));
        await browser.executeScript('document.getElementsByClassName("k-checkbox-label").item(24).click()');
        await browser.executeScript('document.getElementsByClassName("k-checkbox-label").item(26).click()');
        const InvoiceOptionDropdown = await $$('span.k-input').get(2);
        await app.waitForEcClickable(InvoiceOptionDropdown);
        await $$('span.k-input').get(2).click();
        const bulkUpdateMatter = $$('li.k-item').get(2);
        await app.waitForEcClickable(bulkUpdateMatter);
        await bulkUpdateMatter.click();
        await app.waitForMainLoader();
        await expect($('.k-dialog-title').getText()).toBe(data.matterupdate.static_text1);
        await expect($('.cscForm label').getText()).toBe(data.matterupdate.static_text2);
        await expect($('.k-primary.header-button').getText()).toBe(data.matterupdate.static_text3);
        await expect($('.k-tertiary').getText()).toBe(data.matterupdate.static_text4);
        await expect($('.k-dialog-content .no-padding').getText()).toContain(data.matterupdate.static_text5);
        await expect($('.k-dialog-content .no-padding').getText()).toContain(data.matterupdate.static_text6);
        await expect($('[ng-reflect-total="2"]').isPresent()).toBe(true);
        await expect($('[ng-reflect-total="2"] [value="25"]').getText()).toContain(data.matterupdate.pagination1);
        await expect($('[ng-reflect-total="2"] [value="50"]').getText()).toContain(data.matterupdate.pagination2);
        await expect($('[ng-reflect-total="2"] [value="75"]').getText()).toContain(data.matterupdate.pagination3);
        await expect($('[ng-reflect-total="2"] [value="100"]').getText()).toContain(data.matterupdate.pagination4);
        await $('.cscForm .ng-untouched').sendKeys(matter.readExcelMatterNumberUpdate(0, 'B5'));
        await browser.executeScript('document.getElementsByClassName("k-icon k-plus").item(0).click()');
        await browser.executeScript('document.getElementsByClassName("k-checkbox-label").item(30).click()');
        await browser.executeScript('document.getElementsByClassName("k-checkbox-label").item(31).click()');
        await $('.k-primary.header-button').click();
        await $('.k-tertiary').click();
        await app.waitForMainLoader();
        await expect($$('div.toaster-body.csc-success').isDisplayed()).toBeTruthy();
        await browser.sleep(5000);
        await $('[aria-label="Close"]').click();
        await app.waitForMainLoader();
        await browser.executeScript('window.scrollTo(0,0)');
        });

    it('should update matter number of More Than Two Invoices', async () => {
        await browser.sleep(5000);
        await inv.clickSearchButton();
        await app.waitForMainLoader();
        const checkboxes = element.all(by.className('k-checkbox-label'));
        const checkboxes_count = await checkboxes.count();
        await browser.executeScript('document.getElementsByClassName("k-checkbox-label").item(24).click()');
        await browser.executeScript('document.getElementsByClassName("k-checkbox-label").item(25).click()');
        await browser.executeScript('document.getElementsByClassName("k-checkbox-label").item(26).click()');
        const InvoiceOptionDropdown = await $$('span.k-input').get(2);
        await app.waitForEcClickable(InvoiceOptionDropdown);
        await $$('span.k-input').get(2).click();
        const bulkUpdateMatter = $$('li.k-item').get(2);
        await app.waitForEcClickable(bulkUpdateMatter);
        await bulkUpdateMatter.click();
        await app.waitForMainLoader();
        await expect($('.k-dialog-title').getText()).toBe(data.matterupdate.static_text1);
        await expect($('.cscForm label').getText()).toBe(data.matterupdate.static_text2);
        await expect($('.k-primary.header-button').getText()).toBe(data.matterupdate.static_text3);
        await expect($('.k-tertiary').getText()).toBe(data.matterupdate.static_text4);
        await expect($('.k-dialog-content .no-padding').getText()).toContain(data.matterupdate.static_text5);
        await expect($('.k-dialog-content .no-padding').getText()).toContain(data.matterupdate.static_text6);
        await expect($('[ng-reflect-total="3"]').isPresent()).toBe(true);
        await expect($('[ng-reflect-total="3"] [value="25"]').getText()).toContain(data.matterupdate.pagination1);
        await expect($('[ng-reflect-total="3"] [value="50"]').getText()).toContain(data.matterupdate.pagination2);
        await expect($('[ng-reflect-total="3"] [value="75"]').getText()).toContain(data.matterupdate.pagination3);
        await expect($('[ng-reflect-total="3"] [value="100"]').getText()).toContain(data.matterupdate.pagination4);
        await $('.cscForm .ng-untouched').sendKeys(matter.readExcelMatterNumberUpdate(0, 'B2'));
        const checkbox = element.all(by.className('k-checkbox-label')).get(checkboxes_count);
        await browser.executeScript('arguments[0].click();', checkbox);
        await $('.k-primary.header-button').click();
        await $('.k-tertiary').click();
        await app.waitForMainLoader();
        await expect($$('div.toaster-body.csc-success').isDisplayed()).toBeTruthy();
        await browser.sleep(5000);
        await $('[aria-label="Close"]').click();
        await app.waitForMainLoader();
        await browser.executeScript('window.scrollTo(0,0)');
        });

    it('should update matter number irrespective of customer OFAC status at account level', async () => {
        await browser.sleep(5000);
        await app.getChangeCustomer().click();
        await app.setCustomerOrInvoice(app.readExcel(2, 'B10'));
        await app.waitForMainLoader();
        await inv.clickonInvoiceStatusDropdown();
        await browser.sleep(1000);
        await inv.clickonInvoiceStatusDropdownAll();
        await browser.sleep(1000);
        await inv.clickSearchButton();
        await app.waitForMainLoader();
        const checkboxes = element.all(by.className('k-checkbox-label'));
        const checkboxes_count = await checkboxes.count();
        await browser.executeScript('document.getElementsByClassName("k-icon k-i-edit col s2 no-padding right").item(0).click()');
        await app.waitForMainLoader();
        await expect($('.k-dialog-title').getText()).toBe(data.matterupdate.static_text1);
        await expect($('.cscForm label').getText()).toBe(data.matterupdate.static_text2);
        await expect($('.k-primary.header-button').getText()).toBe(data.matterupdate.static_text3);
        await expect($('.k-tertiary').getText()).toBe(data.matterupdate.static_text4);
        await expect($('.k-dialog-content .no-padding').getText()).toContain(data.matterupdate.static_text5);
        await expect($('.k-dialog-content .no-padding').getText()).toContain(data.matterupdate.static_text6);
        await expect($('[ng-reflect-total="1"]').isPresent()).toBe(true);
        await expect($$('[value="25"]').get(0).getText()).toContain(data.matterupdate.pagination1);
        await expect($$('[value="50"]').get(0).getText()).toContain(data.matterupdate.pagination2);
        await expect($$('[value="75"]').get(0).getText()).toContain(data.matterupdate.pagination3);
        await expect($$('[value="100"]').get(0).getText()).toContain(data.matterupdate.pagination4);
        await $('.cscForm .ng-untouched').sendKeys(matter.readExcelMatterNumberUpdate(0, 'B2'));
        const checkbox = element.all(by.className('k-checkbox-label')).get(checkboxes_count);
        await browser.executeScript('arguments[0].click();', checkbox);
        await $('.k-primary.header-button').click();
        await $('.k-tertiary').click();
        await app.waitForMainLoader();
        await expect($$('div.toaster-body.csc-success').isDisplayed()).toBeTruthy();
        await browser.sleep(5000);
        await $('[aria-label="Close"]').click();
        await app.waitForMainLoader();
        await browser.executeScript('window.scrollTo(0,0)');
        });

    it('should verify that maximum length for New Matter Number accepted by the system is 150', async () => {
        await inv.clickonInvoiceTab();
        await browser.sleep(5000);
        await app.getChangeCustomer().click();
        await app.setCustomerOrInvoice(app.readExcel(2, 'B2'));
        await app.waitForMainLoader();
        await browser.sleep(3000);
        await inv.clickonInvoiceStatusDropdown();
        await browser.sleep(1000);
        await inv.clickonInvoiceStatusDropdownAll();
        await browser.sleep(1000);
        await inv.clickSearchButton();
        await app.waitForMainLoader();
        await browser.executeScript('window.scrollTo(0,2000)');
        await matter.FilterInvoice(matter.readExcelMatterNumberUpdate(0, 'B10'));
        await browser.sleep(5000);
        const checkboxes = element.all(by.className('k-checkbox-label'));
        const checkboxes_count = await checkboxes.count();
        await browser.executeScript('document.getElementsByClassName("k-icon k-i-edit col s2 no-padding right").item(0).click()');
        await app.waitForMainLoader();
        await expect($('.k-dialog-title').getText()).toBe(data.matterupdate.static_text1);
        await expect($('.cscForm label').getText()).toBe(data.matterupdate.static_text2);
        await expect($('.k-primary.header-button').getText()).toBe(data.matterupdate.static_text3);
        await expect($('.k-tertiary').getText()).toBe(data.matterupdate.static_text4);
        await expect($('.k-dialog-content .no-padding').getText()).toContain(data.matterupdate.static_text5);
        await expect($('.k-dialog-content .no-padding').getText()).toContain(data.matterupdate.static_text6);
        await expect($('[ng-reflect-total="1"]').isPresent()).toBe(true);
        await expect($$('[value="25"]').get(0).getText()).toContain(data.matterupdate.pagination1);
        await expect($$('[value="50"]').get(0).getText()).toContain(data.matterupdate.pagination2);
        await expect($$('[value="75"]').get(0).getText()).toContain(data.matterupdate.pagination3);
        await expect($$('[value="100"]').get(0).getText()).toContain(data.matterupdate.pagination4);
        // Input 151 chars as new matter
        await $('.cscForm .ng-untouched').sendKeys(matter.readExcelMatterNumberUpdate(0, 'B6'));
        const checkbox = element.all(by.className('k-checkbox-label')).get(checkboxes_count);
        await browser.executeScript('arguments[0].click();', checkbox);
        await $('.k-primary.header-button').click();
        await $('.k-tertiary').click();
        await app.waitForMainLoader();
        await expect($('[ng-reflect-klass="toaster-body"]').isDisplayed()).toBeTruthy();
        await $('.c-i-cancel_1').click();
        await $('[aria-label="Close"]').click();
        await expect($('[ng-reflect-dialog-title="Warning"] [ng-reflect-ng-style]').isDisplayed()).toBeTruthy();
        await expect($('[ng-reflect-dialog-title="Warning"] p').getText()).toContain(data.matterupdate.message);
        await element(by.xpath('//button[contains(text(),"Yes")]')).click();
        await app.waitForMainLoader();
        });

    it('for renewal invoices Matter number should only be at header level and in the Matter number window display only invoice headers', async () => {
        await inv.clickonInvoiceTab();
        await browser.sleep(5000);
        await app.getChangeCustomer().click();
        await app.setCustomerOrInvoice(app.readExcel(2, 'B2'));
        await app.waitForMainLoader();
        await browser.sleep(3000);
        await inv.clickonInvoiceStatusDropdown();
        await browser.sleep(1000);
        await inv.clickonInvoiceStatusDropdownAll();
        await browser.sleep(1000);
        await inv.clickSearchButton();
        await app.waitForMainLoader();
        await browser.executeScript('window.scrollTo(0,2000)');
        await matter.FilterInvoice(matter.readExcelMatterNumberUpdate(0, 'B10'));
        await browser.sleep(5000);
        const checkboxes = element.all(by.className('k-checkbox-label'));
        const checkboxes_count = await checkboxes.count();
        await browser.executeScript('document.getElementsByClassName("k-icon k-i-edit col s2 no-padding right").item(0).click()');
        await app.waitForMainLoader();
        await expect($('.k-dialog-title').getText()).toBe(data.matterupdate.static_text1);
        await expect($('.cscForm label').getText()).toBe(data.matterupdate.static_text2);
        await expect($('.k-primary.header-button').getText()).toBe(data.matterupdate.static_text3);
        await expect($('.k-tertiary').getText()).toBe(data.matterupdate.static_text4);
        await expect($('.k-dialog-content .no-padding').getText()).toContain(data.matterupdate.static_text5);
        await expect($('.k-dialog-content .no-padding').getText()).toContain(data.matterupdate.static_text6);
        await expect($('[ng-reflect-total="1"]').isPresent()).toBe(true);
        await expect($$('[value="25"]').get(0).getText()).toContain(data.matterupdate.pagination1);
        await expect($$('[value="50"]').get(0).getText()).toContain(data.matterupdate.pagination2);
        await expect($$('[value="75"]').get(0).getText()).toContain(data.matterupdate.pagination3);
        await expect($$('[value="100"]').get(0).getText()).toContain(data.matterupdate.pagination4);
        // verify if plus symbol is present
        await expect(element(by.className('k-icon k-plus')).isPresent()).toBeFalsy();
        await $('[aria-label="Close"]').click();
        await app.waitForMainLoader();
        });
});
